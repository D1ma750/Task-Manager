{% extends 'core/base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üë§ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h1>
    <a href="/employees/" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
</div>

<div class="card">
    <div class="card-body">
        <form method="POST">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">–ö–æ–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ *</label>
                        <input type="text" class="form-control" name="employee_code" required
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: EMP-001">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–ò–º—è *</label>
                        <input type="text" class="form-control" name="first_name" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–§–∞–º–∏–ª–∏—è *</label>
                        <input type="text" class="form-control" name="last_name" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Email *</label>
                        <input type="email" class="form-control" name="email" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å *</label>
                        <input type="text" class="form-control" name="position" required
                               placeholder="–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, –ú–µ–Ω–µ–¥–∂–µ—Ä...">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–û—Ç–¥–µ–ª *</label>
                        <input type="text" class="form-control" name="department" required
                               placeholder="IT, –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥...">
                    </div>

                </div>
            </div>

            <!-- üíº –ù–ê–í–´–ö–ò –°–û–¢–†–£–î–ù–ò–ö–ê -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5>üíº –ù–∞–≤—ã–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h5>
                    <button type="button" class="btn btn-outline-success btn-sm" onclick="addSkill()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≤—ã–∫
                    </button>
                </div>
                <div class="card-body">
                    <div id="skills-container">
                        <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞–≤—ã–∫–æ–≤ -->
                        <div class="skill-row row mb-3">
                            <div class="col-md-7">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–≤—ã–∫–∞</label>
                                <input type="text" class="form-control" name="skill_name"
                                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Python, Django, SQL...">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">–£—Ä–æ–≤–µ–Ω—å</label>
                                <select class="form-select" name="skill_level">
                                    <option value="beginner">üë∂ –ù–∞—á–∞–ª—å–Ω—ã–π</option>
                                    <option value="intermediate" selected>üë®‚Äçüíª –°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="expert">üëë –≠–∫—Å–ø–µ—Ä—Ç</option>
                                </select>
                            </div>
                            <div class="col-md-1 d-flex align-items-end">
                                <button type="button" class="btn btn-outline-danger mb-3" onclick="removeSkill(this)" disabled>
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="is_active" checked>
                    <label class="form-check-label">–ê–∫—Ç–∏–≤–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫</label>
                </div>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-success">‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
                <a href="/employees/" class="btn btn-outline-secondary">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>
</div>

<script>
// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–≤—ã–∫–∞–º–∏
function addSkill() {
    const container = document.getElementById('skills-container');
    const newRow = document.createElement('div');
    newRow.className = 'skill-row row mb-3';
    newRow.innerHTML = `
        <div class="col-md-7">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–≤—ã–∫–∞</label>
            <input type="text" class="form-control" name="skill_name"
                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Python, Django, SQL...">
        </div>
        <div class="col-md-4">
            <label class="form-label">–£—Ä–æ–≤–µ–Ω—å</label>
            <select class="form-select" name="skill_level">
                <option value="beginner">üë∂ –ù–∞—á–∞–ª—å–Ω—ã–π</option>
                <option value="intermediate" selected>üë®‚Äçüíª –°—Ä–µ–¥–Ω–∏–π</option>
                <option value="expert">üëë –≠–∫—Å–ø–µ—Ä—Ç</option>
            </select>
        </div>
        <div class="col-md-1 d-flex align-items-end">
            <button type="button" class="btn btn-outline-danger mb-3" onclick="removeSkill(this)">
                üóëÔ∏è
            </button>
        </div>
    `;
    container.appendChild(newRow);
}

function removeSkill(button) {
    const skillRows = document.querySelectorAll('.skill-row');
    if (skillRows.length > 1) {
        button.closest('.skill-row').remove();
    }
}

// –†–∞–∑—Ä–µ—à–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π
document.addEventListener('DOMContentLoaded', function() {
    const addButton = document.querySelector('button[onclick="addSkill()"]');
    const firstRemoveButton = document.querySelector('.skill-row .btn-outline-danger');

    addButton.addEventListener('click', function() {
        // –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑—Ä–µ—à–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π
        const skillRows = document.querySelectorAll('.skill-row');
        if (skillRows.length >= 2) {
            skillRows[0].querySelector('.btn-outline-danger').disabled = false;
        }
    });
});
</script>

<style>
.skill-row {
    transition: all 0.3s ease;
}

.skill-row:hover {
    background-color: #f8f9fa;
    border-radius: 5px;
    padding: 5px;
}
</style>
{% endblock %}